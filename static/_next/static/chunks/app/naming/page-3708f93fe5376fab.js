(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[891],{971:function(e,t,a){Promise.resolve().then(a.bind(a,6960))},6960:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return c}});var s=a(3827),i=a(4090),n=a(7907),r=a(826),l=a(8371);let o={quokka:{welcome:"我是快乐的矮袋鼠，很高兴见到你",image:"/images/pets/quokka.png"},red_panda:{welcome:"我是热心的小熊猫，我会一直在你身边",image:"/images/pets/red_panda.png"},squirrel:{welcome:"我是充满活力的松鼠，我们一起去玩吧",image:"/images/pets/squirrel.png"},white_rabbit:{welcome:"我是温柔的小白兔，我会静静地陪伴你",image:"/images/pets/white_rabbit.png"},hedgehog:{welcome:"我是睿智的刺猬，有什么心事都可以告诉我",image:"/images/pets/hedgehog.png"},hamster:{welcome:"我是勇敢的仓鼠，让我们开始冒险吧",image:"/images/pets/hamster.png"},black_cat:{welcome:"我是冷静的黑猫，我不爱说话，但我懂你",image:"/images/pets/black_cat.png"},unknown:{welcome:"你好呀",image:"/images/pets/egg.png"}};function c(){let e=(0,n.useRouter)(),[t,a]=(0,i.useState)(!0),[c,p]=(0,i.useState)(null),[m,d]=(0,i.useState)(null),[u,g]=(0,i.useState)(""),[x,h]=(0,i.useState)(!1),[b,f]=(0,i.useState)(!1),[y,_]=(0,i.useState)(!1),[w,k]=(0,i.useState)(!1);(0,i.useEffect)(()=>{(async()=>{try{let[t,a]=await Promise.all([r.Z.get("/auth/me"),r.Z.get("/pet/my/all")]);d(t.data),a.data&&a.data.length>0?(p(a.data[0]),setTimeout(()=>f(!0),500),setTimeout(()=>_(!0),2500)):e.push("/claim")}catch(e){console.error("Failed to fetch data:",e)}finally{a(!1)}})()},[e]);let j=async t=>{if(t.preventDefault(),u.trim()){h(!0);try{await r.Z.post("/pet/name",{name:u}),k(!0),setTimeout(()=>{e.push("/home")},1500)}catch(e){console.error("Failed to set pet name:",e),alert("起名失败，请重试"),h(!1)}}};if(t)return(0,s.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-[#FFF8E7]",children:"加载中..."});if(!c||!m)return(0,s.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-[#FFF8E7]",children:"数据加载失败"});let v=o[c.template_id||"unknown"]||o.unknown,N=m.nickname||"主人";return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l.E.div,{initial:{opacity:1},animate:{opacity:b?0:1},transition:{duration:2,ease:"easeOut"},className:"fixed inset-0 bg-white z-50 pointer-events-none"}),(0,s.jsx)("main",{className:"flex min-h-screen flex-col items-center justify-center p-8 bg-cover bg-center bg-no-repeat relative",style:{backgroundImage:"url(/images/backgrounds/home-bg.png)"},children:(0,s.jsxs)(l.E.div,{className:"w-full max-w-md space-y-8",initial:{opacity:0},animate:{opacity:w?0:b?1:0},transition:{duration:w?1:2,ease:"easeInOut"},children:[(0,s.jsx)(l.E.div,{initial:{opacity:0,y:20},animate:{opacity:w?0:y?1:0,y:w||!y?20:0},transition:{duration:.8},className:"space-y-8",children:(0,s.jsx)("div",{className:"bg-white border-4 border-black rounded-3xl p-6 relative shadow-[8px_8px_0px_0px_rgba(0,0,0,1)]",children:(0,s.jsxs)("p",{className:"text-xl font-black text-center leading-relaxed",children:[N,"，",v.welcome,"，给我取个名字吧！"]})})}),(0,s.jsx)("div",{className:"flex justify-center -mt-4 mb-4",children:(0,s.jsx)("img",{src:v.image,alt:"Pet",className:"w-48 h-48 object-contain drop-shadow-xl"})}),(0,s.jsxs)(l.E.form,{initial:{opacity:0,y:20},animate:{opacity:w?0:y?1:0,y:w||!y?20:0},transition:{duration:.8,delay:w?0:.2},onSubmit:j,className:"flex gap-4",children:[(0,s.jsx)("input",{type:"text",required:!0,value:u,onChange:e=>g(e.target.value),placeholder:"输入名字...",className:"flex-1 px-4 py-3 rounded-xl border-2 border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,0.2)] focus:shadow-[2px_2px_0px_0px_rgba(0,0,0,1)] focus:translate-y-[2px] transition-all outline-none text-lg font-bold"}),(0,s.jsx)("button",{type:"submit",disabled:x,className:"px-6 py-3 bg-[#FFB347] text-black border-2 border-black rounded-xl font-black text-lg shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] hover:translate-y-[2px] hover:shadow-[2px_2px_0px_0px_rgba(0,0,0,1)] active:shadow-none active:translate-y-[4px] transition-all disabled:opacity-50",children:x?"...":"确定"})]})]})})]})}},826:function(e,t,a){"use strict";let s=a(3107).Z.create({baseURL:"/api/v1",headers:{"Content-Type":"application/json"}});s.interceptors.request.use(e=>{{let t=localStorage.getItem("linkpet_user_id");t&&(e.headers["X-User-ID"]=t)}return e},e=>Promise.reject(e)),t.Z=s}},function(e){e.O(0,[615,371,971,69,744],function(){return e(e.s=971)}),_N_E=e.O()}]);